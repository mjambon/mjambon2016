<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
  <title>
Camlp4OCamlRevisedParser.ml-3.10.1</title>
  <meta name="GENERATOR" content="caml2html 1.4.2">
<style type="text/css">
code,pre { color:black;background-color:white }a.Cannot { color:black;text-decoration:none }.Cannot:hover { background-color: #b4eeb4; }
.Cbar,
.Cdo,
.Cdone,
.Cdownto,
.Celse,
.Cfor,
.Cif,
.Clazy,
.Cmatch,
.Cnew,
.Cor,
.Cthen,
.Cto,
.Ctry,
.Cwhen,
.Cwhile,
.Cwith { color: #77aaaa; }
.Cassert,
.Cinclude,
.Copen { color: #cc9900; }
.Cstring { color: #aa4444; }
.Cand,
.Cas,
.Cclass,
.Cconstraint,
.Cexception,
.Cexternal,
.Cfun,
.Cfunction,
.Cfunctor,
.Cin,
.Cinherit,
.Cinitializer,
.Clet,
.Cmethod,
.Cmodule,
.Cmutable,
.Cof,
.Cprivate,
.Crec,
.Ctype,
.Cval,
.Cvirtual { color: green; }
.Cbackground { background-color: white; }
.Craise { color: red; }
.Cconstructor { color: #0033cc; }
.Ccomment { color: #990000; }
.Calphakeyword,
.Casr,
.Cland,
.Clor,
.Clsl,
.Clsr,
.Clxor,
.Cmod { color: #808080; }
.Clinenum { color: black; background-color: silver; }
.Cbegin,
.Cend,
.Cobject,
.Csig,
.Cstruct { color: #990099; }
.Cfalse,
.Cnonalphakeyword,
.Cquotation,
.Ctrue { }
</style>
</head>
<body>

<pre><a name="Camlp4OCamlRevisedParser.ml-3.10.1"></a><span class="Copen">open</span> <span class="Cconstructor">Camlp4</span><span class="Cnonalphakeyword">;</span>                                        <span class="Ccomment">(* -*- camlp4r -*- *)</span>
<span class="Ccomment">(****************************************************************************)</span>
<span class="Ccomment">(*                                                                          *)</span>
<span class="Ccomment">(*                              Objective Caml                              *)</span>
<span class="Ccomment">(*                                                                          *)</span>
<span class="Ccomment">(*                            INRIA Rocquencourt                            *)</span>
<span class="Ccomment">(*                                                                          *)</span>
<span class="Ccomment">(*  Copyright 2002-2006 Institut National de Recherche en Informatique et   *)</span>
<span class="Ccomment">(*  en Automatique.  All rights reserved.  This file is distributed under   *)</span>
<span class="Ccomment">(*  the terms of the GNU Library General Public License, with the special   *)</span>
<span class="Ccomment">(*  exception on linking described in LICENSE at the top of the Objective   *)</span>
<span class="Ccomment">(*  Caml source tree.                                                       *)</span>
<span class="Ccomment">(*                                                                          *)</span>
<span class="Ccomment">(****************************************************************************)</span>

<span class="Ccomment">(* Authors:</span>
<span class="Ccomment"> * - Daniel de Rauglaudre: initial version</span>
<span class="Ccomment"> * - Nicolas Pouillard: refactoring</span>
<span class="Ccomment"> *)</span>

<span class="Cmodule">module</span> <span class="Cconstructor">Id</span> <span class="Cnonalphakeyword">=</span> <span class="Cstruct">struct</span>
  value name <span class="Cnonalphakeyword">=</span> <span class="Cstring">"Camlp4OCamlRevisedParser"</span><span class="Cnonalphakeyword">;</span>
  value version <span class="Cnonalphakeyword">=</span> <span class="Cstring">"$Id: Camlp4OCamlRevisedParser.ml,v 1.2.2.31 2007/12/18 09:02:19 ertai Exp $"</span><span class="Cnonalphakeyword">;</span>
<span class="Cend">end</span><span class="Cnonalphakeyword">;</span>

<span class="Cmodule">module</span> <span class="Cconstructor">Make</span> <span class="Cnonalphakeyword">(</span><span class="Cconstructor">Syntax</span> : <span class="Cconstructor">Sig</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Camlp4Syntax</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> <span class="Cstruct">struct</span>
  <span class="Copen">open</span> <span class="Cconstructor">Sig</span><span class="Cnonalphakeyword">;</span>
  <span class="Cinclude">include</span> <span class="Cconstructor">Syntax</span><span class="Cnonalphakeyword">;</span>

  <span class="Ccomment">(* Camlp4_config.constructors_arity.val := True; *)</span>
  <span class="Cconstructor">Camlp4_config</span><span class="Cnonalphakeyword">.</span>constructors_arity<span class="Cnonalphakeyword">.</span><span class="Cval">val</span> <span class="Cnonalphakeyword">:=</span> <span class="Cconstructor">False</span><span class="Cnonalphakeyword">;</span>

  value help_sequences <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span>
    <span class="Cdo">do</span> <span class="Cnonalphakeyword">{</span>
      <span class="Cconstructor">Printf</span><span class="Cnonalphakeyword">.</span>eprintf <span class="Cstring">"\</span>
<span class="Cstring">New syntax:</span>
<span class="Cstring">    (e1; e2; ... ; en) OR begin e1; e2; ... ; en end</span>
<span class="Cstring">    while e do e1; e2; ... ; en done</span>
<span class="Cstring">    for v = v1 to/downto v2 do e1; e2; ... ; en done</span>
<span class="Cstring">Old syntax (still supported):</span>
<span class="Cstring">    do {e1; e2; ... ; en}</span>
<span class="Cstring">    while e do {e1; e2; ... ; en}</span>
<span class="Cstring">    for v = v1 to/downto v2 do {e1; e2; ... ; en}</span>
<span class="Cstring">Very old (no more supported) syntax:</span>
<span class="Cstring">    do e1; e2; ... ; en-1; return en</span>
<span class="Cstring">    while e do e1; e2; ... ; en; done</span>
<span class="Cstring">    for v = v1 to/downto v2 do e1; e2; ... ; en; done</span>
<span class="Cstring">  "</span><span class="Cnonalphakeyword">;</span>
      flush stderr<span class="Cnonalphakeyword">;</span>
      exit 1
    <span class="Cnonalphakeyword">}</span>
  <span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Options</span><span class="Cnonalphakeyword">.</span>add <span class="Cstring">"-help_seq"</span> <span class="Cnonalphakeyword">(</span><span class="Cconstructor">Arg</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Unit</span> help_sequences<span class="Cnonalphakeyword">)</span>
    <span class="Cstring">"Print explanations about new sequences and exit."</span><span class="Cnonalphakeyword">;</span>

  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_CHAR<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_FLOAT<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_INT<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_INT32<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_INT64<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_LABEL<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_LIDENT<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_NATIVEINT<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_OPTLABEL<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_STRING<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_UIDENT<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear a_ident<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear amp_ctyp<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear and_ctyp<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear match_case<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear match_case0<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear match_case_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear binding<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear binding_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear rec_binding_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_declaration<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_description<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_expr_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_fun_binding<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_fun_def<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_info_for_class_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_info_for_class_type<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_longident<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_longident_and_param<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_name_and_param<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_sig_item<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_sig_item_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_signature<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_str_item<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_str_item_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_structure<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_type<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_type_declaration<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_type_longident<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_type_longident_and_param<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_type_plus<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear class_type_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear comma_ctyp<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear comma_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear comma_ipatt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear comma_patt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear comma_type_parameter<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear constrain<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear constructor_arg_list<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear constructor_declaration<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear constructor_declarations<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear ctyp<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear ctyp_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear cvalue_binding<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear direction_flag<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear dummy<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear eq_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear expr_eoi<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear expr_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear field_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear fun_binding<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear fun_def<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear ident<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear ident_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear implem<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear interf<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear ipatt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear ipatt_tcon<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear label<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear label_declaration<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear label_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear label_ipatt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear label_longident<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear label_patt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear labeled_ipatt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear let_binding<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear meth_list<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_binding<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_binding0<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_binding_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_declaration<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_expr_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_longident<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_longident_with_app<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_rec_declaration<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_type<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear module_type_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear more_ctyp<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear name_tags<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_as_lident<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_class_self_patt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_class_self_type<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_comma_ctyp<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_dot_dot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_eq_ctyp<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_meth_list<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_mutable<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_polyt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_private<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_rec<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_virtual<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear opt_when_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear patt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear patt_as_patt_opt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear patt_eoi<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear patt_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear patt_tcon<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear phrase<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear poly_type<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear row_field<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear sem_expr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear sem_expr_for_list<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear sem_patt<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear sem_patt_for_list<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear semi<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear sequence<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear sig_item<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear sig_item_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear sig_items<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear star_ctyp<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear str_item<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear str_item_quot<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear str_items<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear top_phrase<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear type_constraint<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear type_declaration<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear type_ident_and_parameters<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear type_kind<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear type_longident<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear type_longident_and_parameters<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear type_parameter<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear type_parameters<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear typevars<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear use_file<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear val_longident<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear value_let<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear value_val<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear with_constr<span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>clear with_constr_quot<span class="Cnonalphakeyword">;</span>

  value neg_string n <span class="Cnonalphakeyword">=</span>
    <span class="Clet">let</span> len <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>length n <span class="Cin">in</span>
    <span class="Cif">if</span> len <span class="Cnonalphakeyword">&gt;</span> 0 <span class="Cnonalphakeyword">&amp;&amp;</span> n<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>0<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">=</span> <span class="Cstring">'-'</span> <span class="Cthen">then</span> <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>sub n 1 <span class="Cnonalphakeyword">(</span>len <span class="Cnonalphakeyword">-</span> 1<span class="Cnonalphakeyword">)</span>
    <span class="Celse">else</span> <span class="Cstring">"-"</span> ^ n
  <span class="Cnonalphakeyword">;</span>

  value mkumin _loc f arg <span class="Cnonalphakeyword">=</span>
    <span class="Cmatch">match</span> arg <span class="Cwith">with</span>
    <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $int:n$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $int:neg_string n$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $int32:n$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $int32:neg_string n$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $int64:n$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $int64:neg_string n$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $nativeint:n$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $nativeint:neg_string n$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $flo:n$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $flo:neg_string n$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cnonalphakeyword">_</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $lid:"~" ^ f$ $arg$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">;</span>

  value mklistexp _loc last <span class="Cnonalphakeyword">=</span>
    loop <span class="Cconstructor">True</span> where <span class="Crec">rec</span> loop top <span class="Cnonalphakeyword">=</span>
      <span class="Cfun">fun</span>
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span><span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
          <span class="Cmatch">match</span> last <span class="Cwith">with</span>
          <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">Some</span> e <span class="Cnonalphakeyword">-&gt;</span> e
          <span class="Cbar">|</span> <span class="Cconstructor">None</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> [] </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cnonalphakeyword">[</span>e1 <span class="Cnonalphakeyword">::</span> el<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
          <span class="Clet">let</span> _loc <span class="Cnonalphakeyword">=</span>
            <span class="Cif">if</span> top <span class="Cthen">then</span> _loc <span class="Celse">else</span> <span class="Cconstructor">Loc</span><span class="Cnonalphakeyword">.</span>merge <span class="Cnonalphakeyword">(</span><span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span>loc_of_expr e1<span class="Cnonalphakeyword">)</span> _loc
          <span class="Cin">in</span>
          <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> [$e1$ :: $loop False el$] </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
  <span class="Cnonalphakeyword">;</span>

  value mkassert _loc <span class="Cnonalphakeyword">=</span>
    <span class="Cfun">fun</span>
    <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> False </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> assert False </span><span class="Cconstructor">&gt;&gt;</span> <span class="Ccomment">(* this case takes care about</span>
<span class="Ccomment">                                   the special assert false node *)</span>
    <span class="Cbar">|</span> e <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> assert $e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
  <span class="Cnonalphakeyword">;</span>

  value append_eLem el e <span class="Cnonalphakeyword">=</span> el @ <span class="Cnonalphakeyword">[</span>e<span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">;</span>
  value mk_anti <span class="Cnonalphakeyword">?</span><span class="Cnonalphakeyword">(</span>c <span class="Cnonalphakeyword">=</span> <span class="Cstring">""</span><span class="Cnonalphakeyword">)</span> n s <span class="Cnonalphakeyword">=</span> <span class="Cstring">"\\$"</span>^n^c^<span class="Cstring">":"</span>^s<span class="Cnonalphakeyword">;</span>

  value mksequence _loc <span class="Cnonalphakeyword">=</span>
    <span class="Cfun">fun</span>
    <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $_$; $_$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cbar">|</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $anti:_$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cas">as</span> e <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> do { $e$ } </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> e <span class="Cnonalphakeyword">-&gt;</span> e <span class="Cnonalphakeyword">]</span>
  <span class="Cnonalphakeyword">;</span>

  value mksequence' _loc <span class="Cnonalphakeyword">=</span>
    <span class="Cfun">fun</span>
    <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $_$; $_$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cas">as</span> e <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> do { $e$ } </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> e <span class="Cnonalphakeyword">-&gt;</span> e <span class="Cnonalphakeyword">]</span>
  <span class="Cnonalphakeyword">;</span>

  value module_type_app mt1 mt2 <span class="Cnonalphakeyword">=</span>
    <span class="Cmatch">match</span> <span class="Cnonalphakeyword">(</span>mt1<span class="Cnonalphakeyword">,</span> mt2<span class="Cnonalphakeyword">)</span> <span class="Cwith">with</span>
    <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">(</span>&lt;:module_type@_loc<span class="Cnonalphakeyword">&lt;</span> $id:i1$ &gt;&gt;<span class="Cnonalphakeyword">,</span> <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> $id:i2$ </span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> $id:&lt;:ident&lt; $i1$ $i2$ </span><span class="Cconstructor">&gt;&gt;</span>$ &gt;&gt;
    <span class="Cbar">|</span> <span class="Cnonalphakeyword">_</span> <span class="Cnonalphakeyword">-&gt;</span> raise <span class="Cconstructor">Stream</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Failure</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">;</span>

  value module_type_acc mt1 mt2 <span class="Cnonalphakeyword">=</span>
    <span class="Cmatch">match</span> <span class="Cnonalphakeyword">(</span>mt1<span class="Cnonalphakeyword">,</span> mt2<span class="Cnonalphakeyword">)</span> <span class="Cwith">with</span>
    <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">(</span>&lt;:module_type@_loc<span class="Cnonalphakeyword">&lt;</span> $id:i1$ &gt;&gt;<span class="Cnonalphakeyword">,</span> <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> $id:i2$ </span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> $id:&lt;:ident&lt; $i1$.$i2$ </span><span class="Cconstructor">&gt;&gt;</span>$ &gt;&gt;
    <span class="Cbar">|</span> <span class="Cnonalphakeyword">_</span> <span class="Cnonalphakeyword">-&gt;</span> raise <span class="Cconstructor">Stream</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Failure</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">;</span>

  value bigarray_get _loc arr arg <span class="Cnonalphakeyword">=</span>
    <span class="Clet">let</span> coords <span class="Cnonalphakeyword">=</span>
      <span class="Cmatch">match</span> arg <span class="Cwith">with</span>
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ($e1$, $e2$) </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cbar">|</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$, $e2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span>
          <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span>list_of_expr e1 <span class="Cnonalphakeyword">(</span><span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span>list_of_expr e2 <span class="Cnonalphakeyword">[</span><span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">)</span>
      <span class="Cbar">|</span> <span class="Cnonalphakeyword">_</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">[</span>arg<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cin">in</span>
    <span class="Cmatch">match</span> coords <span class="Cwith">with</span>
    <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span>c1<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Array1.get $arr$ $c1$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cnonalphakeyword">[</span>c1<span class="Cnonalphakeyword">;</span> c2<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Array2.get $arr$ $c1$ $c2$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cnonalphakeyword">[</span>c1<span class="Cnonalphakeyword">;</span> c2<span class="Cnonalphakeyword">;</span> c3<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Array3.get $arr$ $c1$ $c2$ $c3$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Ccomment">(* | coords -&gt; &lt;:expr&lt; Bigarray.Genarray.get $arr$ [| $list:coords$ |] &gt;&gt; ] *)</span>
    <span class="Cbar">|</span> coords <span class="Cnonalphakeyword">-&gt;</span>
       <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Genarray.get $arr$ [| $Ast.exSem_of_list coords$ |] </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">;</span>

  value bigarray_set _loc var newval <span class="Cnonalphakeyword">=</span>
    <span class="Cmatch">match</span> var <span class="Cwith">with</span>
    <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Array1.get $arr$ $c1$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">Some</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Array1.set $arr$ $c1$ $newval$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Array2.get $arr$ $c1$ $c2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">Some</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Array2.set $arr$ $c1$ $c2$ $newval$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Array3.get $arr$ $c1$ $c2$ $c3$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">Some</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Array3.set $arr$ $c1$ $c2$ $c3$ $newval$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Genarray.get $arr$ [| $coords$ |] </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">Some</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> Bigarray.Genarray.set $arr$ [| $coords$ |] $newval$ </span><span class="Cconstructor">&gt;&gt;</span>
    <span class="Cbar">|</span> <span class="Cnonalphakeyword">_</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">None</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">;</span>

  value test_not_left_brace_nor_do <span class="Cnonalphakeyword">=</span>
    <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>of_parser <span class="Cstring">"test_not_left_brace_nor_do"</span>
      <span class="Cnonalphakeyword">(</span><span class="Cfun">fun</span> strm <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cmatch">match</span> <span class="Cconstructor">Stream</span><span class="Cnonalphakeyword">.</span>peek strm <span class="Cwith">with</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">Some</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> <span class="Cstring">"{"</span> <span class="Cbar">|</span> <span class="Cconstructor">KEYWORD</span> <span class="Cstring">"do"</span><span class="Cnonalphakeyword">,</span> <span class="Cnonalphakeyword">_</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">-&gt;</span> raise <span class="Cconstructor">Stream</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Failure</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">_</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">;</span>

  value stopped_at _loc <span class="Cnonalphakeyword">=</span>
    <span class="Cconstructor">Some</span> <span class="Cnonalphakeyword">(</span><span class="Cconstructor">Loc</span><span class="Cnonalphakeyword">.</span>move_line 1 _loc<span class="Cnonalphakeyword">)</span> <span class="Ccomment">(* FIXME be more precise *)</span><span class="Cnonalphakeyword">;</span>

  value symbolchar <span class="Cnonalphakeyword">=</span>
    <span class="Clet">let</span> list <span class="Cnonalphakeyword">=</span>
      <span class="Cnonalphakeyword">[</span><span class="Cstring">'$'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'!'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'%'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'&amp;'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'*'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'+'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'-'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'.'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'/'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">':'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'&lt;'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'='</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'&gt;'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'?'</span><span class="Cnonalphakeyword">;</span>
       <span class="Cstring">'@'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'^'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'|'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'~'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'\\'</span><span class="Cnonalphakeyword">]</span>
    <span class="Cin">in</span>
    <span class="Clet">let</span> <span class="Crec">rec</span> loop s i <span class="Cnonalphakeyword">=</span>
      <span class="Cif">if</span> i == <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>length s <span class="Cthen">then</span> <span class="Cconstructor">True</span>
      <span class="Celse">else</span> <span class="Cif">if</span> <span class="Cconstructor">List</span><span class="Cnonalphakeyword">.</span>mem s<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>i<span class="Cnonalphakeyword">]</span> list <span class="Cthen">then</span> loop s <span class="Cnonalphakeyword">(</span>i <span class="Cnonalphakeyword">+</span> 1<span class="Cnonalphakeyword">)</span>
      <span class="Celse">else</span> <span class="Cconstructor">False</span>
    <span class="Cin">in</span>
    loop
  <span class="Cnonalphakeyword">;</span>

  <span class="Clet">let</span> list <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span><span class="Cstring">'!'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'?'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'~'</span><span class="Cnonalphakeyword">]</span> <span class="Cin">in</span>
  <span class="Clet">let</span> excl <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span><span class="Cstring">"!="</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"??"</span><span class="Cnonalphakeyword">]</span> <span class="Cin">in</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>setup_parser prefixop
    <span class="Cnonalphakeyword">(</span>parser
      <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> x <span class="Cbar">|</span> <span class="Cconstructor">SYMBOL</span> x<span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span>
          <span class="Cwhen">when</span>
            not <span class="Cnonalphakeyword">(</span><span class="Cconstructor">List</span><span class="Cnonalphakeyword">.</span>mem x excl<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">&amp;&amp;</span> <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>length x &gt;= 2 <span class="Cnonalphakeyword">&amp;&amp;</span>
            <span class="Cconstructor">List</span><span class="Cnonalphakeyword">.</span>mem x<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>0<span class="Cnonalphakeyword">]</span> list <span class="Cnonalphakeyword">&amp;&amp;</span> symbolchar x 1 :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $lid:x$ </span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span>
  <span class="Cnonalphakeyword">;</span>

  <span class="Clet">let</span> list_ok <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span><span class="Cstring">"&lt;"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&gt;"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&lt;="</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&gt;="</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&lt;&gt;"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"=="</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"!="</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"$"</span><span class="Cnonalphakeyword">]</span> <span class="Cin">in</span> 
  <span class="Clet">let</span> list_first_char_ok <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span><span class="Cstring">'='</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'&lt;'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'&gt;'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'|'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'&amp;'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'$'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'!'</span><span class="Cnonalphakeyword">]</span> <span class="Cin">in</span>
  <span class="Clet">let</span> excl <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span><span class="Cstring">"&lt;-"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"||"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&amp;&amp;"</span><span class="Cnonalphakeyword">]</span> <span class="Cin">in</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>setup_parser infixop0
    <span class="Cnonalphakeyword">(</span>parser
      <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> x <span class="Cbar">|</span> <span class="Cconstructor">SYMBOL</span> x<span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span>
          <span class="Cwhen">when</span>
            <span class="Cnonalphakeyword">(</span><span class="Cconstructor">List</span><span class="Cnonalphakeyword">.</span>mem x list_ok<span class="Cnonalphakeyword">)</span> ||
            <span class="Cnonalphakeyword">(</span>not <span class="Cnonalphakeyword">(</span><span class="Cconstructor">List</span><span class="Cnonalphakeyword">.</span>mem x excl<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">&amp;&amp;</span> <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>length x &gt;= 2 <span class="Cnonalphakeyword">&amp;&amp;</span>
              <span class="Cconstructor">List</span><span class="Cnonalphakeyword">.</span>mem x<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>0<span class="Cnonalphakeyword">]</span> list_first_char_ok <span class="Cnonalphakeyword">&amp;&amp;</span> symbolchar x 1<span class="Cnonalphakeyword">)</span> :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $lid:x$ </span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span>
  <span class="Cnonalphakeyword">;</span>

  <span class="Clet">let</span> list <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span><span class="Cstring">'@'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'^'</span><span class="Cnonalphakeyword">]</span> <span class="Cin">in</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>setup_parser infixop1
    <span class="Cnonalphakeyword">(</span>parser
      <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> x <span class="Cbar">|</span> <span class="Cconstructor">SYMBOL</span> x<span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span>
          <span class="Cwhen">when</span>
            <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>length x &gt;= 1 <span class="Cnonalphakeyword">&amp;&amp;</span> <span class="Cconstructor">List</span><span class="Cnonalphakeyword">.</span>mem x<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>0<span class="Cnonalphakeyword">]</span> list <span class="Cnonalphakeyword">&amp;&amp;</span>
            symbolchar x 1 :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $lid:x$ </span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span>
  <span class="Cnonalphakeyword">;</span>

  <span class="Clet">let</span> list <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span><span class="Cstring">'+'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'-'</span><span class="Cnonalphakeyword">]</span> <span class="Cin">in</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>setup_parser infixop2
    <span class="Cnonalphakeyword">(</span>parser
      <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> x <span class="Cbar">|</span> <span class="Cconstructor">SYMBOL</span> x<span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span>
          <span class="Cwhen">when</span>
            x &lt;&gt; <span class="Cstring">"-&gt;"</span> <span class="Cnonalphakeyword">&amp;&amp;</span> <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>length x &gt;= 1 <span class="Cnonalphakeyword">&amp;&amp;</span> <span class="Cconstructor">List</span><span class="Cnonalphakeyword">.</span>mem x<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>0<span class="Cnonalphakeyword">]</span> list <span class="Cnonalphakeyword">&amp;&amp;</span>
            symbolchar x 1 :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $lid:x$ </span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span>
  <span class="Cnonalphakeyword">;</span>

  <span class="Clet">let</span> list <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span><span class="Cstring">'*'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'/'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'%'</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">'\\'</span><span class="Cnonalphakeyword">]</span> <span class="Cin">in</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>setup_parser infixop3
    <span class="Cnonalphakeyword">(</span>parser
      <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> x <span class="Cbar">|</span> <span class="Cconstructor">SYMBOL</span> x<span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span>
          <span class="Cwhen">when</span>
            <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>length x &gt;= 1 <span class="Cnonalphakeyword">&amp;&amp;</span> <span class="Cconstructor">List</span><span class="Cnonalphakeyword">.</span>mem x<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>0<span class="Cnonalphakeyword">]</span> list <span class="Cnonalphakeyword">&amp;&amp;</span>
            <span class="Cnonalphakeyword">(</span>x<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>0<span class="Cnonalphakeyword">]</span> &lt;&gt; <span class="Cstring">'*'</span> || <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>length x <span class="Cnonalphakeyword">&lt;</span> 2 || x<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>1<span class="Cnonalphakeyword">]</span> &lt;&gt; <span class="Cstring">'*'</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">&amp;&amp;</span>
            symbolchar x 1 :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $lid:x$ </span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span>
  <span class="Cnonalphakeyword">;</span>

  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>setup_parser infixop4
    <span class="Cnonalphakeyword">(</span>parser
      <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> x <span class="Cbar">|</span> <span class="Cconstructor">SYMBOL</span> x<span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span>
          <span class="Cwhen">when</span>
            <span class="Cconstructor">String</span><span class="Cnonalphakeyword">.</span>length x &gt;= 2 <span class="Cnonalphakeyword">&amp;&amp;</span> x<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>0<span class="Cnonalphakeyword">]</span> == <span class="Cstring">'*'</span> <span class="Cnonalphakeyword">&amp;&amp;</span> x<span class="Cnonalphakeyword">.</span><span class="Cnonalphakeyword">[</span>1<span class="Cnonalphakeyword">]</span> == <span class="Cstring">'*'</span> <span class="Cnonalphakeyword">&amp;&amp;</span>
            symbolchar x 2 :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $lid:x$ </span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span>
  <span class="Cnonalphakeyword">;</span>

  value <span class="Crec">rec</span> infix_kwds_filter <span class="Cnonalphakeyword">=</span>
    parser
    <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">,</span> <span class="Cnonalphakeyword">_</span><span class="Cnonalphakeyword">)</span> <span class="Cas">as</span> tok<span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">;</span> xs :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
        <span class="Cmatch">match</span> xs <span class="Cwith">with</span> parser
        <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"mod"</span><span class="Cbar">|</span><span class="Cstring">"land"</span><span class="Cbar">|</span><span class="Cstring">"lor"</span><span class="Cbar">|</span><span class="Cstring">"lxor"</span><span class="Cbar">|</span><span class="Cstring">"lsl"</span><span class="Cbar">|</span><span class="Cstring">"lsr"</span><span class="Cbar">|</span><span class="Cstring">"asr"</span> <span class="Cas">as</span> i<span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">;</span>
             <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> <span class="Cstring">")"</span><span class="Cnonalphakeyword">,</span> <span class="Cnonalphakeyword">_</span><span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">;</span> xs :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
                <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">LIDENT</span> i<span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">;</span> infix_kwds_filter xs :<span class="Cnonalphakeyword">]</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">[</span>: xs :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span>
                <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span>tok<span class="Cnonalphakeyword">;</span> infix_kwds_filter xs :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cbar">|</span> <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span>x<span class="Cnonalphakeyword">;</span> xs :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span>x<span class="Cnonalphakeyword">;</span> infix_kwds_filter xs :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">;</span>

  <span class="Cconstructor">Token</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Filter</span><span class="Cnonalphakeyword">.</span>define_filter <span class="Cnonalphakeyword">(</span><span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span>get_filter <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">)</span>
    <span class="Cnonalphakeyword">(</span><span class="Cfun">fun</span> f strm <span class="Cnonalphakeyword">-&gt;</span> infix_kwds_filter <span class="Cnonalphakeyword">(</span>f strm<span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">;</span>

  <span class="Ccomment">(* transmit the context *)</span>
  <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Entry</span><span class="Cnonalphakeyword">.</span>setup_parser sem_expr <span class="Cbegin">begin</span>
    <span class="Clet">let</span> symb1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">Gram</span><span class="Cnonalphakeyword">.</span>parse_tokens_after_filter expr <span class="Cin">in</span>
    <span class="Clet">let</span> symb <span class="Cnonalphakeyword">=</span>
      parser
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span> :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"expr;" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cbar">|</span> <span class="Cnonalphakeyword">[</span>: a <span class="Cnonalphakeyword">=</span> symb1 :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> a <span class="Cnonalphakeyword">]</span>
    <span class="Cin">in</span>
    <span class="Clet">let</span> <span class="Crec">rec</span> kont al <span class="Cnonalphakeyword">=</span>
      parser
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span>: <span class="Cconstructor">`</span><span class="Cnonalphakeyword">(</span><span class="Cconstructor">KEYWORD</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">,</span> _loc<span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">;</span> a <span class="Cnonalphakeyword">=</span> symb<span class="Cnonalphakeyword">;</span> s :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> kont <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $al$; $a$ </span><span class="Cconstructor">&gt;&gt;</span> s
      <span class="Cbar">|</span> <span class="Cnonalphakeyword">[</span>: :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> al <span class="Cnonalphakeyword">]</span>
    <span class="Cin">in</span>
    parser <span class="Cnonalphakeyword">[</span>: a <span class="Cnonalphakeyword">=</span> symb<span class="Cnonalphakeyword">;</span> s :<span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> kont a s
  <span class="Cend">end</span><span class="Cnonalphakeyword">;</span>

  <span class="Cconstructor">EXTEND</span> <span class="Cconstructor">Gram</span>
    <span class="Cconstructor">GLOBAL</span>:
      a_CHAR a_FLOAT a_INT a_INT32 a_INT64 a_LABEL a_LIDENT rec_binding_quot
      a_NATIVEINT a_OPTLABEL a_STRING a_UIDENT a_ident
      amp_ctyp and_ctyp match_case match_case0 match_case_quot binding binding_quot
      class_declaration class_description class_expr class_expr_quot
      class_fun_binding class_fun_def class_info_for_class_expr
      class_info_for_class_type class_longident class_longident_and_param
      class_name_and_param class_sig_item class_sig_item_quot class_signature
      class_str_item class_str_item_quot class_structure class_type
      class_type_declaration class_type_longident
      class_type_longident_and_param class_type_plus class_type_quot
      comma_ctyp comma_expr comma_ipatt comma_patt comma_type_parameter
      constrain constructor_arg_list constructor_declaration
      constructor_declarations ctyp ctyp_quot cvalue_binding direction_flag
      dummy eq_expr expr expr_eoi expr_quot field_expr fun_binding
      fun_def ident ident_quot implem interf ipatt ipatt_tcon label
      label_declaration label_expr label_ipatt label_longident label_patt
      labeled_ipatt let_binding meth_list module_binding module_binding0
      module_binding_quot module_declaration module_expr module_expr_quot
      module_longident module_longident_with_app module_rec_declaration
      module_type module_type_quot more_ctyp name_tags opt_as_lident
      opt_class_self_patt opt_class_self_type opt_comma_ctyp opt_dot_dot opt_eq_ctyp opt_expr
      opt_meth_list opt_mutable opt_polyt opt_private opt_rec
      opt_virtual opt_when_expr patt patt_as_patt_opt patt_eoi
      patt_quot patt_tcon phrase poly_type row_field
      sem_expr sem_expr_for_list sem_patt sem_patt_for_list semi sequence
      sig_item sig_item_quot sig_items star_ctyp str_item str_item_quot
      str_items top_phrase type_constraint type_declaration
      type_ident_and_parameters type_kind type_longident
      type_longident_and_parameters type_parameter type_parameters typevars
      use_file val_longident value_let value_val with_constr with_constr_quot
      infixop0 infixop1 infixop2 infixop3 infixop4 do_sequence<span class="Cnonalphakeyword">;</span>
    module_expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"top"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"functor"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> module_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span>
          me <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> functor ( $i$ : $t$ ) -&gt; $me$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"struct"</span><span class="Cnonalphakeyword">;</span> st <span class="Cnonalphakeyword">=</span> str_items<span class="Cnonalphakeyword">;</span> <span class="Cstring">"end"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> struct $st$ end </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"apply"</span>
        <span class="Cnonalphakeyword">[</span> me1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> me2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> $me1$ $me2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"simple"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"mexp"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"module_expr" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>module_expr_tag
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> module_longident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> $id:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> me <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> ( $me$ : $mt$ ) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> me <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> $me$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    str_item:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"top"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"exception"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> constructor_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> exception $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"exception"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> constructor_declaration<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> type_longident <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> exception $t$ = $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"external"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> sl <span class="Cnonalphakeyword">=</span> string_list <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> external $i$ : $t$ = $sl$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"include"</span><span class="Cnonalphakeyword">;</span> me <span class="Cnonalphakeyword">=</span> module_expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> include $me$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> mb <span class="Cnonalphakeyword">=</span> module_binding0 <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> module $i$ = $mb$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"rec"</span><span class="Cnonalphakeyword">;</span> mb <span class="Cnonalphakeyword">=</span> module_binding <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> module rec $mb$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"type"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> module type $i$ = $mt$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"open"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> module_longident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> open $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"type"</span><span class="Cnonalphakeyword">;</span> td <span class="Cnonalphakeyword">=</span> type_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> type $td$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> value_let<span class="Cnonalphakeyword">;</span> r <span class="Cnonalphakeyword">=</span> opt_rec<span class="Cnonalphakeyword">;</span> bi <span class="Cnonalphakeyword">=</span> binding <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> value $rec:r$ $bi$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"class"</span><span class="Cnonalphakeyword">;</span> cd <span class="Cnonalphakeyword">=</span> class_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> class $cd$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"class"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"type"</span><span class="Cnonalphakeyword">;</span> ctd <span class="Cnonalphakeyword">=</span> class_type_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> class type $ctd$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"stri"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"str_item" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>str_item_tag
        <span class="Cbar">|</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> $exp:e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_binding0:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span><span class="Cnonalphakeyword">;</span> mb <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> functor ( $m$ : $mt$ ) -&gt; $mb$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> me <span class="Cnonalphakeyword">=</span> module_expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> ( $me$ : $mt$ ) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> me <span class="Cnonalphakeyword">=</span> module_expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"> $me$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_binding:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> b1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> b2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $b1$ and $b2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"module_binding"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"module_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"module_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> m<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> me <span class="Cnonalphakeyword">=</span> module_expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $mk_anti n m$ : $mt$ = $me$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>module_binding_tag
        <span class="Cbar">|</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> me <span class="Cnonalphakeyword">=</span> module_expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $m$ : $mt$ = $me$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_type:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"top"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"functor"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> functor ( $i$ : $t$ ) -&gt; $mt$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"with"</span>
        <span class="Cnonalphakeyword">[</span> mt <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"with"</span><span class="Cnonalphakeyword">;</span> wc <span class="Cnonalphakeyword">=</span> with_constr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> $mt$ with $wc$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"apply"</span>
        <span class="Cnonalphakeyword">[</span> mt1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> mt2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> dummy <span class="Cnonalphakeyword">-&gt;</span> module_type_app mt1 mt2 <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"."</span>
        <span class="Cnonalphakeyword">[</span> mt1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> mt2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> module_type_acc mt1 mt2 <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"sig"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"sig"</span><span class="Cnonalphakeyword">;</span> sg <span class="Cnonalphakeyword">=</span> sig_items<span class="Cnonalphakeyword">;</span> <span class="Cstring">"end"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> sig $sg$ end </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"simple"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"mtyp"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"module_type" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>module_type_tag
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> module_longident_with_app <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> $id:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"'"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> ' $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> $mt$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    sig_item:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"top"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"sigi"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"sig_item" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>sig_item_tag
        <span class="Cbar">|</span> <span class="Cstring">"exception"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> constructor_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> exception $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"external"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> sl <span class="Cnonalphakeyword">=</span> string_list <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> external $i$ : $t$ = $sl$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"include"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> include $mt$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> module $i$ : $mt$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"rec"</span><span class="Cnonalphakeyword">;</span> mb <span class="Cnonalphakeyword">=</span> module_rec_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> module rec $mb$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"type"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> module type $i$ = $mt$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"type"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> module type $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"open"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> module_longident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> open $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"type"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> type_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> type $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> value_val<span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> value $i$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"class"</span><span class="Cnonalphakeyword">;</span> cd <span class="Cnonalphakeyword">=</span> class_description <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> class $cd$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"class"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"type"</span><span class="Cnonalphakeyword">;</span> ctd <span class="Cnonalphakeyword">=</span> class_type_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> class type $ctd$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_declaration:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> $mt$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> module_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"> functor ( $i$ : $t$ ) -&gt; $mt$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_rec_declaration:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> m1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> m2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $m1$ and $m2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"module_binding"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"module_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>module_binding_tag
        <span class="Cbar">|</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $m$ : $mt$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    with_constr:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> wc1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> wc2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:with_constr&lt;</span><span class="Cquotation"> $wc1$ and $wc2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"with_constr"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:with_constr&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"with_constr" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>with_constr_tag
        <span class="Cbar">|</span> <span class="Cstring">"type"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:with_constr&lt;</span><span class="Cquotation"> type $anti:mk_anti ~c:"ctyp" n s$ = $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"type"</span><span class="Cnonalphakeyword">;</span> t1 <span class="Cnonalphakeyword">=</span> type_longident_and_parameters<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:with_constr&lt;</span><span class="Cquotation"> type $t1$ = $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> i1 <span class="Cnonalphakeyword">=</span> module_longident<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> i2 <span class="Cnonalphakeyword">=</span> module_longident_with_app <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:with_constr&lt;</span><span class="Cquotation"> module $i1$ = $i2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"top"</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"let"</span><span class="Cnonalphakeyword">;</span> r <span class="Cnonalphakeyword">=</span> opt_rec<span class="Cnonalphakeyword">;</span> bi <span class="Cnonalphakeyword">=</span> binding<span class="Cnonalphakeyword">;</span> <span class="Cstring">"in"</span><span class="Cnonalphakeyword">;</span> x <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> let $rec:r$ $bi$ in $x$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"let"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> mb <span class="Cnonalphakeyword">=</span> module_binding0<span class="Cnonalphakeyword">;</span> <span class="Cstring">"in"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> let module $m$ = $mb$ in $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"fun"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> a <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">LIST0</span> match_case0 <span class="Cconstructor">SEP</span> <span class="Cstring">"|"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> fun [ $list:a$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"fun"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> fun_def <span class="Cnonalphakeyword">-&gt;</span> e
        <span class="Cbar">|</span> <span class="Cstring">"match"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> sequence<span class="Cnonalphakeyword">;</span> <span class="Cstring">"with"</span><span class="Cnonalphakeyword">;</span> a <span class="Cnonalphakeyword">=</span> match_case <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> match $mksequence' _loc e$ with [ $a$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"try"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> sequence<span class="Cnonalphakeyword">;</span> <span class="Cstring">"with"</span><span class="Cnonalphakeyword">;</span> a <span class="Cnonalphakeyword">=</span> match_case <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> try $mksequence' _loc e$ with [ $a$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"if"</span><span class="Cnonalphakeyword">;</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"then"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"else"</span><span class="Cnonalphakeyword">;</span> e3 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> if $e1$ then $e2$ else $e3$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"do"</span><span class="Cnonalphakeyword">;</span> seq <span class="Cnonalphakeyword">=</span> do_sequence <span class="Cnonalphakeyword">-&gt;</span> mksequence _loc seq
        <span class="Cbar">|</span> <span class="Cstring">"for"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e1 <span class="Cnonalphakeyword">=</span> sequence<span class="Cnonalphakeyword">;</span> df <span class="Cnonalphakeyword">=</span> direction_flag<span class="Cnonalphakeyword">;</span>
          e2 <span class="Cnonalphakeyword">=</span> sequence<span class="Cnonalphakeyword">;</span> <span class="Cstring">"do"</span><span class="Cnonalphakeyword">;</span> seq <span class="Cnonalphakeyword">=</span> do_sequence <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> for $i$ = $mksequence' _loc e1$ $to:df$ $mksequence' _loc e2$ do { $seq$ } </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"while"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> sequence<span class="Cnonalphakeyword">;</span> <span class="Cstring">"do"</span><span class="Cnonalphakeyword">;</span> seq <span class="Cnonalphakeyword">=</span> do_sequence <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> while $mksequence' _loc e$ do { $seq$ } </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"object"</span><span class="Cnonalphakeyword">;</span> csp <span class="Cnonalphakeyword">=</span> opt_class_self_patt<span class="Cnonalphakeyword">;</span> cst <span class="Cnonalphakeyword">=</span> class_structure<span class="Cnonalphakeyword">;</span> <span class="Cstring">"end"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> object ($csp$) $cst$ end </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"where"</span>
        <span class="Cnonalphakeyword">[</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"where"</span><span class="Cnonalphakeyword">;</span> rf <span class="Cnonalphakeyword">=</span> opt_rec<span class="Cnonalphakeyword">;</span> lb <span class="Cnonalphakeyword">=</span> let_binding <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> let $rec:rf$ $lb$ in $e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">":="</span> <span class="Cconstructor">NONA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">":="</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> dummy <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cmatch">match</span> bigarray_set _loc e1 e2 <span class="Cwith">with</span>
            <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">Some</span> e <span class="Cnonalphakeyword">-&gt;</span> e
            <span class="Cbar">|</span> <span class="Cconstructor">None</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ := $e2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"||"</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> op <span class="Cnonalphakeyword">=</span> infixop6<span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $op$ $e1$ $e2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"&amp;&amp;"</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> op <span class="Cnonalphakeyword">=</span> infixop5<span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $op$ $e1$ $e2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"&lt;"</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> op <span class="Cnonalphakeyword">=</span> infixop0<span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $op$ $e1$ $e2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"^"</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> op <span class="Cnonalphakeyword">=</span> infixop1<span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $op$ $e1$ $e2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"+"</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> op <span class="Cnonalphakeyword">=</span> infixop2<span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $op$ $e1$ $e2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"*"</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"land"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ land $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"lor"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ lor $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"lxor"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ lxor $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"mod"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ mod $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> op <span class="Cnonalphakeyword">=</span> infixop3<span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $op$ $e1$ $e2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"**"</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"asr"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ asr $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"lsl"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ lsl $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"lsr"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ lsr $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> op <span class="Cnonalphakeyword">=</span> infixop4<span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $op$ $e1$ $e2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"unary minus"</span> <span class="Cconstructor">NONA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"-"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> mkumin _loc <span class="Cstring">"-"</span> e
        <span class="Cbar">|</span> <span class="Cstring">"-."</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> mkumin _loc <span class="Cstring">"-."</span> e <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"apply"</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"assert"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> mkassert _loc e
        <span class="Cbar">|</span> <span class="Cstring">"new"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> class_longident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> new $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"lazy"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> lazy $e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"label"</span> <span class="Cconstructor">NONA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ~ $i$ : $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ~ $i$ </span><span class="Cconstructor">&gt;&gt;</span>

        <span class="Ccomment">(* Here it's LABEL and not tilde_label since ~a:b is different than ~a : b *)</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">LABEL</span> i<span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ~ $i$ : $e$ </span><span class="Cconstructor">&gt;&gt;</span>

        <span class="Ccomment">(* Same remark for ?a:b *)</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">OPTLABEL</span> i<span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ? $i$ : $e$ </span><span class="Cconstructor">&gt;&gt;</span>

        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ? $i$ : $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ? $i$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"."</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ .( $e2$ ) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ .[ $e2$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"{"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> comma_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">"}"</span> <span class="Cnonalphakeyword">-&gt;</span> bigarray_get _loc e1 e2
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$ . $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"#"</span><span class="Cnonalphakeyword">;</span> lab <span class="Cnonalphakeyword">=</span> label <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e$ # $lab$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"~-"</span> <span class="Cconstructor">NONA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"!"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e$.val </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> f <span class="Cnonalphakeyword">=</span> prefixop<span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $f$ $e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"simple"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>expr_tag
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"exp"</span><span class="Cbar">|</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"expr" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"`bool"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $id:&lt;:ident&lt; $anti:mk_anti n s$ </span><span class="Cconstructor">&gt;&gt;</span>$ &gt;&gt;
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"tup"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $tup: &lt;:expr&lt; $anti:mk_anti ~c:"expr" n s$ </span><span class="Cconstructor">&gt;&gt;</span>$ &gt;&gt;
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"seq"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> do $anti:mk_anti ~c:"expr" n s$ done </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_INT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $int:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_INT32 <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $int32:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_INT64 <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $int64:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_NATIVEINT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $nativeint:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_FLOAT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $flo:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_STRING <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $str:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_CHAR <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $chr:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> val_longident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $id:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"`"</span><span class="Cnonalphakeyword">;</span> s <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ` $s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> [] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> mk_list <span class="Cnonalphakeyword">=</span> sem_expr_for_list<span class="Cnonalphakeyword">;</span> <span class="Cstring">"::"</span><span class="Cnonalphakeyword">;</span> last <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            mk_list last
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> mk_list <span class="Cnonalphakeyword">=</span> sem_expr_for_list<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            mk_list <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> [] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"[|"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"|]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> [| $&lt;:expr&lt;</span><span class="Cconstructor">&gt;&gt;</span>$ <span class="Cnonalphakeyword">|]</span> &gt;&gt;
        <span class="Cbar">|</span> <span class="Cstring">"[|"</span><span class="Cnonalphakeyword">;</span> el <span class="Cnonalphakeyword">=</span> sem_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">"|]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> [| $el$ |] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"{"</span><span class="Cnonalphakeyword">;</span> el <span class="Cnonalphakeyword">=</span> label_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">"}"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> { $el$ } </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"{"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"with"</span><span class="Cnonalphakeyword">;</span> el <span class="Cnonalphakeyword">=</span> label_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">"}"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> { ($e$) with $el$ } </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"{&lt;"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&gt;}"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> {&lt;&gt;} </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"{&lt;"</span><span class="Cnonalphakeyword">;</span> fel <span class="Cnonalphakeyword">=</span> field_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">"&gt;}"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> {&lt; $fel$ &gt;} </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> () </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ($e$ : $t$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> el <span class="Cnonalphakeyword">=</span> comma_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ( $e$, $el$ ) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> seq <span class="Cnonalphakeyword">=</span> sequence<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> mksequence _loc <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e$; $seq$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">":&gt;"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ($e$ : $t$ :&gt; $t2$ ) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">":&gt;"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ($e$ :&gt; $t$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> e
        <span class="Cbar">|</span> <span class="Cstring">"begin"</span><span class="Cnonalphakeyword">;</span> seq <span class="Cnonalphakeyword">=</span> sequence<span class="Cnonalphakeyword">;</span> <span class="Cstring">"end"</span> <span class="Cnonalphakeyword">-&gt;</span> mksequence _loc seq
        <span class="Cbar">|</span> <span class="Cstring">"begin"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"end"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> () </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    do_sequence:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"{"</span><span class="Cnonalphakeyword">;</span> seq <span class="Cnonalphakeyword">=</span> sequence<span class="Cnonalphakeyword">;</span> <span class="Cstring">"}"</span> <span class="Cnonalphakeyword">-&gt;</span> seq
        <span class="Cbar">|</span> test_not_left_brace_nor_do<span class="Cnonalphakeyword">;</span> seq <span class="Cnonalphakeyword">=</span> sequence<span class="Cnonalphakeyword">;</span> <span class="Cstring">"done"</span> <span class="Cnonalphakeyword">-&gt;</span> seq
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    infixop5:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"&amp;"</span> <span class="Cbar">|</span> <span class="Cstring">"&amp;&amp;"</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $lid:x$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    infixop6:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"or"</span> <span class="Cbar">|</span> <span class="Cstring">"||"</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $lid:x$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    sem_expr_for_list:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> e <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> el <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> acc <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> [ $e$ :: $el acc$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> acc <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> [ $e$ :: $acc$ ] </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    comma_expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$, $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"expr," n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> e <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    dummy:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    sequence':
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> e <span class="Cnonalphakeyword">-&gt;</span> e
        <span class="Cbar">|</span> <span class="Cstring">";"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> e <span class="Cnonalphakeyword">-&gt;</span> e
        <span class="Cbar">|</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> el <span class="Cnonalphakeyword">=</span> sequence <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> e <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e$; $el$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    sequence:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"let"</span><span class="Cnonalphakeyword">;</span> rf <span class="Cnonalphakeyword">=</span> opt_rec<span class="Cnonalphakeyword">;</span> bi <span class="Cnonalphakeyword">=</span> binding<span class="Cnonalphakeyword">;</span> <span class="Cstring">"in"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> k <span class="Cnonalphakeyword">=</span> sequence' <span class="Cnonalphakeyword">-&gt;</span>
            k <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> let $rec:rf$ $bi$ in $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"let"</span><span class="Cnonalphakeyword">;</span> rf <span class="Cnonalphakeyword">=</span> opt_rec<span class="Cnonalphakeyword">;</span> bi <span class="Cnonalphakeyword">=</span> binding<span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> el <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> let $rec:rf$ $bi$ in $mksequence _loc el$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"let"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> mb <span class="Cnonalphakeyword">=</span> module_binding0<span class="Cnonalphakeyword">;</span> <span class="Cstring">"in"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> k <span class="Cnonalphakeyword">=</span> sequence' <span class="Cnonalphakeyword">-&gt;</span>
            k <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> let module $m$ = $mb$ in $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"let"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"module"</span><span class="Cnonalphakeyword">;</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> mb <span class="Cnonalphakeyword">=</span> module_binding0<span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> el <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> let module $m$ = $mb$ in $mksequence _loc el$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"expr;" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> k <span class="Cnonalphakeyword">=</span> sequence' <span class="Cnonalphakeyword">-&gt;</span> k e <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    binding:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"binding"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt" n s$ = $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> b1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> b2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:binding&lt;</span><span class="Cquotation"> $b1$ and $b2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> b <span class="Cnonalphakeyword">=</span> let_binding <span class="Cnonalphakeyword">-&gt;</span> b
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    let_binding:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> p <span class="Cnonalphakeyword">=</span> ipatt<span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> fun_binding <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:binding&lt;</span><span class="Cquotation"> $p$ = $e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    fun_binding:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> p <span class="Cnonalphakeyword">=</span> labeled_ipatt<span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> fun $p$ -&gt; $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ($e$ : $t$) </span><span class="Cconstructor">&gt;&gt;</span> 
        <span class="Cbar">|</span> <span class="Cstring">":&gt;"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ($e$ :&gt; $t$) </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    match_case:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">LIST0</span> match_case0 <span class="Cconstructor">SEP</span> <span class="Cstring">"|"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span>mcOr_of_list l
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> ipatt<span class="Cnonalphakeyword">;</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:match_case&lt;</span><span class="Cquotation"> $p$ -&gt; $e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    match_case0:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"match_case"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:match_case&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"match_case" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:match_case&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"match_case" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:match_case&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt" n s$ -&gt; $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> <span class="Cstring">"when"</span><span class="Cnonalphakeyword">;</span> w <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:match_case&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt" n s$ when $w$ -&gt; $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> patt_as_patt_opt<span class="Cnonalphakeyword">;</span> w <span class="Cnonalphakeyword">=</span> opt_when_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:match_case&lt;</span><span class="Cquotation"> $p$ when $w$ -&gt; $e$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_when_expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"when"</span><span class="Cnonalphakeyword">;</span> w <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> w
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    patt_as_patt_opt:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> p1 <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">"as"</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> patt <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p1$ as $p2$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> patt <span class="Cnonalphakeyword">-&gt;</span> p
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    label_expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> b1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> b2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $b1$ ; $b2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"rec_binding"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"rec_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"rec_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ident" n s$ = $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"rec_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> label_longident<span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> fun_binding <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $i$ = $e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    fun_def:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> p <span class="Cnonalphakeyword">=</span> labeled_ipatt<span class="Cnonalphakeyword">;</span> <span class="Cnonalphakeyword">(</span>w<span class="Cnonalphakeyword">,</span> e<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> fun_def_cont <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> fun [ $p$ when $w$ -&gt; $e$ ] </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    fun_def_cont:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> p <span class="Cnonalphakeyword">=</span> labeled_ipatt<span class="Cnonalphakeyword">;</span> <span class="Cnonalphakeyword">(</span>w<span class="Cnonalphakeyword">,</span>e<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">,</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> fun [ $p$ when $w$ -&gt; $e$ ] </span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cstring">"when"</span><span class="Cnonalphakeyword">;</span> w <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span>w<span class="Cnonalphakeyword">,</span> e<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">,</span> e<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    patt:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"|"</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> p1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"|"</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $p1$ | $p2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">".."</span> <span class="Cconstructor">NONA</span>
        <span class="Cnonalphakeyword">[</span> p1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">".."</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $p1$ .. $p2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"apply"</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> p1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $p1$ $p2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"simple"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"pat"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"tup"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($tup:&lt;:patt&lt; $anti:mk_anti ~c:"patt" n s$ </span><span class="Cconstructor">&gt;&gt;</span>$<span class="Cnonalphakeyword">)</span> &gt;&gt;
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"`bool"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $id:&lt;:ident&lt; $anti:mk_anti n s$ </span><span class="Cconstructor">&gt;&gt;</span>$ &gt;&gt;
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $id:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_INT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $int:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_INT32 <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $int32:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_INT64 <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $int64:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_NATIVEINT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $nativeint:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_FLOAT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $flo:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_STRING <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $str:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_CHAR <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $chr:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"-"</span><span class="Cnonalphakeyword">;</span> s <span class="Cnonalphakeyword">=</span> a_INT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $int:neg_string s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"-"</span><span class="Cnonalphakeyword">;</span> s <span class="Cnonalphakeyword">=</span> a_INT32 <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $int32:neg_string s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"-"</span><span class="Cnonalphakeyword">;</span> s <span class="Cnonalphakeyword">=</span> a_INT64 <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $int64:neg_string s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"-"</span><span class="Cnonalphakeyword">;</span> s <span class="Cnonalphakeyword">=</span> a_NATIVEINT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $nativeint:neg_string s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"-"</span><span class="Cnonalphakeyword">;</span> s <span class="Cnonalphakeyword">=</span> a_FLOAT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $flo:neg_string s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> [] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> mk_list <span class="Cnonalphakeyword">=</span> sem_patt_for_list<span class="Cnonalphakeyword">;</span> <span class="Cstring">"::"</span><span class="Cnonalphakeyword">;</span> last <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            mk_list last
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> mk_list <span class="Cnonalphakeyword">=</span> sem_patt_for_list<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            mk_list <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> [] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"[|"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"|]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> [| $&lt;:patt&lt;</span><span class="Cconstructor">&gt;&gt;</span>$ <span class="Cnonalphakeyword">|]</span> &gt;&gt;
        <span class="Cbar">|</span> <span class="Cstring">"[|"</span><span class="Cnonalphakeyword">;</span> pl <span class="Cnonalphakeyword">=</span> sem_patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">"|]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> [| $pl$ |] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"{"</span><span class="Cnonalphakeyword">;</span> pl <span class="Cnonalphakeyword">=</span> label_patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">"}"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> { $pl$ } </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> () </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> p
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p$ : $t$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"as"</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p$ as $p2$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> pl <span class="Cnonalphakeyword">=</span> comma_patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p$, $pl$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"_"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> _ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>patt_tag
        <span class="Cbar">|</span> <span class="Cstring">"`"</span><span class="Cnonalphakeyword">;</span> s <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ` $s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"#"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> type_longident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> # $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">LABEL</span> i<span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ~ $i$ : $p$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"lid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> i<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ~ $mk_anti n i$ : $p$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"lid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> i <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ~ $mk_anti n i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">LIDENT</span> i <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ~ $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Ccomment">(* | i = opt_label; "("; p = patt_tcon; ")" -&gt; *)</span>
            <span class="Ccomment">(* &lt;:patt&lt; ? $i$ : ($p$) &gt;&gt; *)</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">OPTLABEL</span> i<span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> patt_tcon<span class="Cnonalphakeyword">;</span> f <span class="Cnonalphakeyword">=</span> eq_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> f i p
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"lid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> i<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> patt_tcon<span class="Cnonalphakeyword">;</span> f <span class="Cnonalphakeyword">=</span> eq_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span>
            f <span class="Cnonalphakeyword">(</span>mk_anti n i<span class="Cnonalphakeyword">)</span> p
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">LIDENT</span> i <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"lid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> i <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? $mk_anti n i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> patt_tcon<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? ($p$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> patt_tcon<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? ($p$ = $e$) </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    comma_patt:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> p1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $p1$, $p2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt," n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> patt <span class="Cnonalphakeyword">-&gt;</span> p <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    sem_patt:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> p1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $p1$; $p2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt;" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> patt <span class="Cnonalphakeyword">-&gt;</span> p <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    sem_patt_for_list:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> p <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> pl <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> acc <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> [ $p$ :: $pl acc$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> patt <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> acc <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> [ $p$ :: $acc$ ] </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    label_patt:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> p1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $p1$; $p2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"pat"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>patt_tag
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt;" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> label_longident<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> patt <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $i$ = $p$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    ipatt:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"{"</span><span class="Cnonalphakeyword">;</span> pl <span class="Cnonalphakeyword">=</span> label_ipatt<span class="Cnonalphakeyword">;</span> <span class="Cstring">"}"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> { $pl$ } </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"pat"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"tup"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($tup:&lt;:patt&lt; $anti:mk_anti ~c:"patt" n s$ </span><span class="Cconstructor">&gt;&gt;</span>$<span class="Cnonalphakeyword">)</span> &gt;&gt;
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>patt_tag
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> () </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> p
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p$ : $t$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"as"</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p$ as $p2$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> pl <span class="Cnonalphakeyword">=</span> comma_ipatt<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p$, $pl$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $lid:s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"_"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> _ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    labeled_ipatt:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> p <span class="Cnonalphakeyword">=</span> ipatt <span class="Cnonalphakeyword">-&gt;</span> p <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    comma_ipatt:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> p1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $p1$, $p2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt," n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> ipatt <span class="Cnonalphakeyword">-&gt;</span> p <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    label_ipatt:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> p1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> p2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $p1$; $p2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"pat"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"patt;" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>patt_tag
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> label_longident<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> ipatt <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $i$ = $p$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    type_declaration:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctypand" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>ctyp_tag
        <span class="Cbar">|</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ and $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">(</span>n<span class="Cnonalphakeyword">,</span> tpl<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> type_ident_and_parameters<span class="Cnonalphakeyword">;</span> tk <span class="Cnonalphakeyword">=</span> opt_eq_ctyp<span class="Cnonalphakeyword">;</span>
          cl <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">LIST0</span> constrain <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">TyDcl</span> _loc n tpl tk cl <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    constrain:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"constraint"</span><span class="Cnonalphakeyword">;</span> t1 <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span>t1<span class="Cnonalphakeyword">,</span> t2<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_eq_ctyp:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> tk <span class="Cnonalphakeyword">=</span> type_kind <span class="Cnonalphakeyword">-&gt;</span> tk
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    type_kind:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> t <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    type_ident_and_parameters:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> tpl <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">LIST0</span> type_parameter <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span>i<span class="Cnonalphakeyword">,</span> tpl<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    type_longident_and_parameters:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> type_longident<span class="Cnonalphakeyword">;</span> tpl <span class="Cnonalphakeyword">=</span> type_parameters <span class="Cnonalphakeyword">-&gt;</span> tpl <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $id:i$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    type_parameters:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> type_parameter<span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cfun">fun</span> acc <span class="Cnonalphakeyword">-&gt;</span> t2 <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $acc$ $t1$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t <span class="Cnonalphakeyword">=</span> type_parameter <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> acc <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $acc$ $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> t <span class="Cnonalphakeyword">-&gt;</span> t
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    type_parameter:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>ctyp_tag
        <span class="Cbar">|</span> <span class="Cstring">"'"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> '$lid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"+"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"'"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> +'$lid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"-"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"'"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> -'$lid:i$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    ctyp:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"=="</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"=="</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ == $t2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"private"</span> <span class="Cconstructor">NONA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"private"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cconstructor">LEVEL</span> <span class="Cstring">"alias"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> private $t$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"alias"</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"as"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ as $t2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"forall"</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"!"</span><span class="Cnonalphakeyword">;</span> t1 <span class="Cnonalphakeyword">=</span> typevars<span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> ! $t1$ . $t2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"arrow"</span> <span class="Cconstructor">RIGHTA</span>
        <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ -&gt; $t2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"label"</span> <span class="Cconstructor">NONA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> ~ $i$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_LABEL<span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span>  <span class="Cconstructor">SELF</span>  <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> ~ $i$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> ? $i$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_OPTLABEL<span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> ? $i$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"apply"</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Clet">let</span> t <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ $t2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cin">in</span>
            <span class="Ctry">try</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $id:Ast.ident_of_ctyp t$ </span><span class="Cconstructor">&gt;&gt;</span>
            <span class="Cwith">with</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">Invalid_argument</span> <span class="Cnonalphakeyword">_</span> <span class="Cnonalphakeyword">-&gt;</span> t <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"."</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Ctry">try</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $id:Ast.ident_of_ctyp t1$.$id:Ast.ident_of_ctyp t2$ </span><span class="Cconstructor">&gt;&gt;</span>
            <span class="Cwith">with</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">Invalid_argument</span> s <span class="Cnonalphakeyword">-&gt;</span> raise <span class="Cnonalphakeyword">(</span><span class="Cconstructor">Stream</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">Error</span> s<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"simple"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"'"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> '$i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"_"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> _ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"tup"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> ($tup:&lt;:ctyp&lt; $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>$<span class="Cnonalphakeyword">)</span> &gt;&gt;
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"id"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $id:&lt;:ident&lt; $anti:mk_anti ~c:"ident" n s$ </span><span class="Cconstructor">&gt;&gt;</span>$ &gt;&gt;
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>ctyp_tag
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $lid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $uid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"*"</span><span class="Cnonalphakeyword">;</span> tl <span class="Cnonalphakeyword">=</span> star_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> ( $t$ * $tl$ ) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> t
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> constructor_declarations<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> [ $t$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> rfl <span class="Cnonalphakeyword">=</span> row_field<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> [ = $rfl$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&gt;"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> [ &gt; $&lt;:ctyp&lt;</span><span class="Cconstructor">&gt;&gt;</span>$ <span class="Cnonalphakeyword">]</span> &gt;&gt;
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&gt;"</span><span class="Cnonalphakeyword">;</span> rfl <span class="Cnonalphakeyword">=</span> row_field<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> [ &gt; $rfl$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&lt;"</span><span class="Cnonalphakeyword">;</span> rfl <span class="Cnonalphakeyword">=</span> row_field<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> [ &lt; $rfl$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&lt;"</span><span class="Cnonalphakeyword">;</span> rfl <span class="Cnonalphakeyword">=</span> row_field<span class="Cnonalphakeyword">;</span> <span class="Cstring">"&gt;"</span><span class="Cnonalphakeyword">;</span> ntl <span class="Cnonalphakeyword">=</span> name_tags<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> [ &lt; $rfl$ &gt; $ntl$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"[&lt;"</span><span class="Cnonalphakeyword">;</span> rfl <span class="Cnonalphakeyword">=</span> row_field<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> [ &lt; $rfl$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"[&lt;"</span><span class="Cnonalphakeyword">;</span> rfl <span class="Cnonalphakeyword">=</span> row_field<span class="Cnonalphakeyword">;</span> <span class="Cstring">"&gt;"</span><span class="Cnonalphakeyword">;</span> ntl <span class="Cnonalphakeyword">=</span> name_tags<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> [ &lt; $rfl$ &gt; $ntl$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"{"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> label_declaration<span class="Cnonalphakeyword">;</span> <span class="Cconstructor">OPT</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"}"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> { $t$ } </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"#"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> class_longident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> # $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"&lt;"</span><span class="Cnonalphakeyword">;</span> ml <span class="Cnonalphakeyword">=</span> opt_meth_list<span class="Cnonalphakeyword">;</span> v <span class="Cnonalphakeyword">=</span> opt_dot_dot<span class="Cnonalphakeyword">;</span> <span class="Cstring">"&gt;"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> &lt; $ml$ $..:v$ &gt; </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    star_ctyp:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp*" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"*"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ * $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> t
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    constructor_declarations:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp|" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>ctyp_tag
        <span class="Cbar">|</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"|"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ | $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">"of"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> constructor_arg_list <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $uid:s$ of $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $uid:s$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    constructor_declaration:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>ctyp_tag
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">"of"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> constructor_arg_list <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $uid:s$ of $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $uid:s$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    constructor_arg_list:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctypand" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ and $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> t
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    label_declaration:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$; $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp;" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>ctyp_tag
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span>  <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $lid:s$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> s <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"mutable"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $lid:s$ : mutable $t$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_ident:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> i
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span> i <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    ident:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"id"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ident" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $uid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $lid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"id"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ident" n s$.$i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> j <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $uid:i$.$j$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_longident:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"id"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ident" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $uid:m$.$l$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $uid:i$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_longident_with_app:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"apply"</span>
        <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> j <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $i$ $j$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"."</span>
        <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> j <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $i$.$j$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"simple"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"id"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ident" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $uid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> i <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    type_longident:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"apply"</span>
        <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> j <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $i$ $j$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"."</span>
        <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> j <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $i$.$j$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"simple"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"id"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ident" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $lid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $uid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> i <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    label_longident:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"id"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ident" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $uid:m$.$l$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $lid:i$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_type_longident:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> type_longident <span class="Cnonalphakeyword">-&gt;</span> x <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    val_longident:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> ident <span class="Cnonalphakeyword">-&gt;</span> x <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_longident:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> label_longident <span class="Cnonalphakeyword">-&gt;</span> x <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_declaration:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> c1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> c2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $c1$ and $c2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"cdcl"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_expr" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>class_expr_tag
        <span class="Cbar">|</span> ci <span class="Cnonalphakeyword">=</span> class_info_for_class_expr<span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> class_fun_binding <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $ci$ = $ce$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_fun_binding:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> class_expr <span class="Cnonalphakeyword">-&gt;</span> ce
        <span class="Cbar">|</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> ct <span class="Cnonalphakeyword">=</span> class_type_plus<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> class_expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> ($ce$ : $ct$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> labeled_ipatt<span class="Cnonalphakeyword">;</span> cfb <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> fun $p$ -&gt; $cfb$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_info_for_class_type:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> mv <span class="Cnonalphakeyword">=</span> opt_virtual<span class="Cnonalphakeyword">;</span> <span class="Cnonalphakeyword">(</span>i<span class="Cnonalphakeyword">,</span> ot<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> class_name_and_param <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $virtual:mv$ $lid:i$ [ $ot$ ] </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_info_for_class_expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> mv <span class="Cnonalphakeyword">=</span> opt_virtual<span class="Cnonalphakeyword">;</span> <span class="Cnonalphakeyword">(</span>i<span class="Cnonalphakeyword">,</span> ot<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> class_name_and_param <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $virtual:mv$ $lid:i$ [ $ot$ ] </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_name_and_param:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> x <span class="Cnonalphakeyword">=</span> comma_type_parameter<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span>i<span class="Cnonalphakeyword">,</span> x<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span>i<span class="Cnonalphakeyword">,</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span><span class="Cnonalphakeyword">)</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    comma_type_parameter:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$, $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp," n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t <span class="Cnonalphakeyword">=</span> type_parameter <span class="Cnonalphakeyword">-&gt;</span> t
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_comma_ctyp:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> x <span class="Cnonalphakeyword">=</span> comma_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    comma_ctyp:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$, $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp," n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> t
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_fun_def:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> p <span class="Cnonalphakeyword">=</span> labeled_ipatt<span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> fun $p$ -&gt; $ce$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> class_expr <span class="Cnonalphakeyword">-&gt;</span> ce <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"top"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cstring">"fun"</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> labeled_ipatt<span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> class_fun_def <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> fun $p$ -&gt; $ce$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"let"</span><span class="Cnonalphakeyword">;</span> rf <span class="Cnonalphakeyword">=</span> opt_rec<span class="Cnonalphakeyword">;</span> bi <span class="Cnonalphakeyword">=</span> binding<span class="Cnonalphakeyword">;</span> <span class="Cstring">"in"</span><span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> let $rec:rf$ $bi$ in $ce$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"apply"</span> <span class="Cconstructor">NONA</span>
        <span class="Cnonalphakeyword">[</span> ce <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cconstructor">LEVEL</span> <span class="Cstring">"label"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $ce$ $e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"simple"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"cexp"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_expr" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>class_expr_tag
        <span class="Cbar">|</span> ce <span class="Cnonalphakeyword">=</span> class_longident_and_param <span class="Cnonalphakeyword">-&gt;</span> ce
        <span class="Cbar">|</span> <span class="Cstring">"object"</span><span class="Cnonalphakeyword">;</span> csp <span class="Cnonalphakeyword">=</span> opt_class_self_patt<span class="Cnonalphakeyword">;</span> cst <span class="Cnonalphakeyword">=</span> class_structure<span class="Cnonalphakeyword">;</span> <span class="Cstring">"end"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> object ($csp$) $cst$ end </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> ct <span class="Cnonalphakeyword">=</span> class_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> ($ce$ : $ct$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> ce <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_longident_and_param:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> ci <span class="Cnonalphakeyword">=</span> class_longident<span class="Cnonalphakeyword">;</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> comma_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
          <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $id:ci$ [ $t$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> ci <span class="Cnonalphakeyword">=</span> class_longident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $id:ci$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_structure:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"cst"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_str_item" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"cst"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> cst <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_str_item" n s$; $cst$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> l <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">LIST0</span> <span class="Cnonalphakeyword">[</span> cst <span class="Cnonalphakeyword">=</span> class_str_item<span class="Cnonalphakeyword">;</span> semi <span class="Cnonalphakeyword">-&gt;</span> cst <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span>crSem_of_list l
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_class_self_patt:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> p
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p$ : $t$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_str_item:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"cst"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_str_item" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>class_str_item_tag
        <span class="Cbar">|</span> <span class="Cstring">"inherit"</span><span class="Cnonalphakeyword">;</span> ce <span class="Cnonalphakeyword">=</span> class_expr<span class="Cnonalphakeyword">;</span> pb <span class="Cnonalphakeyword">=</span> opt_as_lident <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> inherit $ce$ as $pb$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> value_val<span class="Cnonalphakeyword">;</span> mf <span class="Cnonalphakeyword">=</span> opt_mutable<span class="Cnonalphakeyword">;</span> lab <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> cvalue_binding <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> value $mutable:mf$ $lab$ = $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> value_val<span class="Cnonalphakeyword">;</span> mf <span class="Cnonalphakeyword">=</span> opt_mutable<span class="Cnonalphakeyword">;</span> <span class="Cstring">"virtual"</span><span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> value virtual $mutable:mf$ $l$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> value_val<span class="Cnonalphakeyword">;</span> <span class="Cstring">"virtual"</span><span class="Cnonalphakeyword">;</span> mf <span class="Cnonalphakeyword">=</span> opt_mutable<span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> value virtual $mutable:mf$ $l$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"method"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"virtual"</span><span class="Cnonalphakeyword">;</span> pf <span class="Cnonalphakeyword">=</span> opt_private<span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> method virtual $private:pf$ $l$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"method"</span><span class="Cnonalphakeyword">;</span> pf <span class="Cnonalphakeyword">=</span> opt_private<span class="Cnonalphakeyword">;</span> <span class="Cstring">"virtual"</span><span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> method virtual $private:pf$ $l$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"method"</span><span class="Cnonalphakeyword">;</span> pf <span class="Cnonalphakeyword">=</span> opt_private<span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> topt <span class="Cnonalphakeyword">=</span> opt_polyt<span class="Cnonalphakeyword">;</span>
          e <span class="Cnonalphakeyword">=</span> fun_binding <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> method $private:pf$ $l$ : $topt$ = $e$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> type_constraint<span class="Cnonalphakeyword">;</span> t1 <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> type $t1$ = $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"initializer"</span><span class="Cnonalphakeyword">;</span> se <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> initializer $se$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_as_lident:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"as"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> i
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cstring">""</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_polyt:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span> t
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    cvalue_binding:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> e
        <span class="Cbar">|</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ($e$ : $t$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">":&gt;"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ($e$ : $t$ :&gt; $t2$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">":&gt;"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> ($e$ :&gt; $t$) </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    label:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> i <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_type:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"ctyp"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_type" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>class_type_tag
        <span class="Cbar">|</span> ct <span class="Cnonalphakeyword">=</span> class_type_longident_and_param <span class="Cnonalphakeyword">-&gt;</span> ct
        <span class="Cbar">|</span> <span class="Cstring">"object"</span><span class="Cnonalphakeyword">;</span> cst <span class="Cnonalphakeyword">=</span> opt_class_self_type<span class="Cnonalphakeyword">;</span> csg <span class="Cnonalphakeyword">=</span> class_signature<span class="Cnonalphakeyword">;</span> <span class="Cstring">"end"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> object ($cst$) $csg$ end </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_type_longident_and_param:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> class_type_longident<span class="Cnonalphakeyword">;</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> comma_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $id:i$ [ $t$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> class_type_longident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $id:i$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_type_plus:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"["</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"]"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"-&gt;"</span><span class="Cnonalphakeyword">;</span> ct <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> [ $t$ ] -&gt; $ct$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> ct <span class="Cnonalphakeyword">=</span> class_type <span class="Cnonalphakeyword">-&gt;</span> ct <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_class_self_type:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> t
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_signature:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"csg"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_sig_item" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"csg"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> csg <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_sig_item" n s$; $csg$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> l <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">LIST0</span> <span class="Cnonalphakeyword">[</span> csg <span class="Cnonalphakeyword">=</span> class_sig_item<span class="Cnonalphakeyword">;</span> semi <span class="Cnonalphakeyword">-&gt;</span> csg <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span>cgSem_of_list l
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_sig_item:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"csg"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_sig_item" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>class_sig_item_tag
        <span class="Cbar">|</span> <span class="Cstring">"inherit"</span><span class="Cnonalphakeyword">;</span> cs <span class="Cnonalphakeyword">=</span> class_type <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> inherit $cs$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> value_val<span class="Cnonalphakeyword">;</span> mf <span class="Cnonalphakeyword">=</span> opt_mutable<span class="Cnonalphakeyword">;</span> mv <span class="Cnonalphakeyword">=</span> opt_virtual<span class="Cnonalphakeyword">;</span>
          l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> value $mutable:mf$ $virtual:mv$ $l$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"method"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"virtual"</span><span class="Cnonalphakeyword">;</span> pf <span class="Cnonalphakeyword">=</span> opt_private<span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> method virtual $private:pf$ $l$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"method"</span><span class="Cnonalphakeyword">;</span> pf <span class="Cnonalphakeyword">=</span> opt_private<span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> method $private:pf$ $l$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"method"</span><span class="Cnonalphakeyword">;</span> pf <span class="Cnonalphakeyword">=</span> opt_private<span class="Cnonalphakeyword">;</span> <span class="Cstring">"virtual"</span><span class="Cnonalphakeyword">;</span> l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> method virtual $private:pf$ $l$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> type_constraint<span class="Cnonalphakeyword">;</span> t1 <span class="Cnonalphakeyword">=</span> ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> type $t1$ = $t2$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    type_constraint:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"type"</span> <span class="Cbar">|</span> <span class="Cstring">"constraint"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_description:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> cd1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> cd2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $cd1$ and $cd2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_type" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>class_type_tag
        <span class="Cbar">|</span> ci <span class="Cnonalphakeyword">=</span> class_info_for_class_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> ct <span class="Cnonalphakeyword">=</span> class_type_plus <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $ci$ : $ct$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_type_declaration:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> cd1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> cd2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $cd1$ and $cd2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"class_type" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>class_type_tag
        <span class="Cbar">|</span> ci <span class="Cnonalphakeyword">=</span> class_info_for_class_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> ct <span class="Cnonalphakeyword">=</span> class_type <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $ci$ = $ct$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    field_expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> b1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> b2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $b1$ ; $b2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"bi"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"rec_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"rec_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> l <span class="Cnonalphakeyword">=</span> label<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cconstructor">LEVEL</span> <span class="Cstring">"top"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"> $lid:l$ = $e$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    meth_list:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> ml1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> ml2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span>        <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $ml1$; $ml2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s        <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s          <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp;" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x                       <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>ctyp_tag
        <span class="Cbar">|</span> lab <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> poly_type <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $lid:lab$ : $t$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_meth_list:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> ml <span class="Cnonalphakeyword">=</span> meth_list<span class="Cnonalphakeyword">;</span> <span class="Cconstructor">OPT</span> <span class="Cstring">";"</span> <span class="Cnonalphakeyword">-&gt;</span> ml
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    poly_type:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> t <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    typevars:
      <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">LEFTA</span>
        <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">QUOTATION</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span>expand _loc x <span class="Cconstructor">Quotation</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">DynAst</span><span class="Cnonalphakeyword">.</span>ctyp_tag
        <span class="Cbar">|</span> <span class="Cstring">"'"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> '$lid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    row_field:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp|" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"|"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ | $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"`"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> `$i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"`"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident<span class="Cnonalphakeyword">;</span> <span class="Cstring">"of"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&amp;"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> amp_ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> `$i$ of &amp; $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"`"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident<span class="Cnonalphakeyword">;</span> <span class="Cstring">"of"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> amp_ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> `$i$ of $t$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> t <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    amp_ctyp:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&amp;"</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ &amp; $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp&amp;" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> t
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    name_tags:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"typ"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ctyp" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> t1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> t2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $t1$ $t2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"`"</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> `$i$ </span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    eq_expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> i p <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? $i$ : ($p$ = $e$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cfun">fun</span> i p <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? $i$ : ($p$) </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    patt_tcon:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> p <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p$ : $t$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> patt <span class="Cnonalphakeyword">-&gt;</span> p <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    ipatt:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">LABEL</span> i<span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ~ $i$ : $p$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"lid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> i<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ~ $mk_anti n i$ : $p$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"lid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> i <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ~ $mk_anti n i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">LIDENT</span> i <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ~ $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Ccomment">(* | i = opt_label; "("; p = ipatt_tcon; ")" -&gt;</span>
<span class="Ccomment">            &lt;:patt&lt; ? $i$ : ($p$) &gt;&gt;</span>
<span class="Ccomment">        | i = opt_label; "("; p = ipatt_tcon; "="; e = expr; ")" -&gt;</span>
<span class="Ccomment">            &lt;:patt&lt; ? $i$ : ($p$ = $e$) &gt;&gt;                             *)</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">OPTLABEL</span> i<span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> ipatt_tcon<span class="Cnonalphakeyword">;</span> f <span class="Cnonalphakeyword">=</span> eq_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> f i p
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"lid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> i<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> ipatt_tcon<span class="Cnonalphakeyword">;</span>
          f <span class="Cnonalphakeyword">=</span> eq_expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> f <span class="Cnonalphakeyword">(</span>mk_anti n i<span class="Cnonalphakeyword">)</span> p
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">LIDENT</span> i <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? $i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"lid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> i <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? $mk_anti n i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> ipatt_tcon<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? ($p$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> p <span class="Cnonalphakeyword">=</span> ipatt_tcon<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> e <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ? ($p$ = $e$) </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    ipatt_tcon:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> p <span class="Cnonalphakeyword">=</span> ipatt<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> t <span class="Cnonalphakeyword">=</span> ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> ($p$ : $t$) </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> p <span class="Cnonalphakeyword">=</span> ipatt <span class="Cnonalphakeyword">-&gt;</span> p <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    direction_flag:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"to"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BTrue</span>
        <span class="Cbar">|</span> <span class="Cstring">"downto"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BFalse</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"to"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BAnt</span> <span class="Cnonalphakeyword">(</span>mk_anti n s<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_private:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"private"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BTrue</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"private"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BAnt</span> <span class="Cnonalphakeyword">(</span>mk_anti n s<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BFalse</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_mutable:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"mutable"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BTrue</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"mutable"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BAnt</span> <span class="Cnonalphakeyword">(</span>mk_anti n s<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BFalse</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_virtual:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"virtual"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BTrue</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"virtual"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BAnt</span> <span class="Cnonalphakeyword">(</span>mk_anti n s<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BFalse</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_dot_dot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">".."</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BTrue</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">".."</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BAnt</span> <span class="Cnonalphakeyword">(</span>mk_anti n s<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BFalse</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_rec:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"rec"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BTrue</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"rec"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BAnt</span> <span class="Cnonalphakeyword">(</span>mk_anti n s<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BFalse</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    opt_expr:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> e
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    interf:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"#"</span><span class="Cnonalphakeyword">;</span> n <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> dp <span class="Cnonalphakeyword">=</span> opt_expr<span class="Cnonalphakeyword">;</span> semi <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">[</span> <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> # $n$ $dp$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">,</span> stopped_at _loc<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> si <span class="Cnonalphakeyword">=</span> sig_item<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> <span class="Cnonalphakeyword">(</span>sil<span class="Cnonalphakeyword">,</span> stopped<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">[</span>si <span class="Cnonalphakeyword">::</span> sil<span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">,</span> stopped<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">EOI</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">[</span><span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">,</span> <span class="Cconstructor">None</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    sig_items:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"sigi"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> $anti:mk_anti n ~c:"sig_item" s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"sigi"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> sg <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> $anti:mk_anti n ~c:"sig_item" s$; $sg$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> l <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">LIST0</span> <span class="Cnonalphakeyword">[</span> sg <span class="Cnonalphakeyword">=</span> sig_item<span class="Cnonalphakeyword">;</span> semi <span class="Cnonalphakeyword">-&gt;</span> sg <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span>sgSem_of_list l
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    implem:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"#"</span><span class="Cnonalphakeyword">;</span> n <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> dp <span class="Cnonalphakeyword">=</span> opt_expr<span class="Cnonalphakeyword">;</span> semi <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">[</span> <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> # $n$ $dp$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">,</span> stopped_at _loc<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> si <span class="Cnonalphakeyword">=</span> str_item<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> <span class="Cnonalphakeyword">(</span>sil<span class="Cnonalphakeyword">,</span> stopped<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">[</span>si <span class="Cnonalphakeyword">::</span> sil<span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">,</span> stopped<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">EOI</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">[</span><span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">,</span> <span class="Cconstructor">None</span><span class="Cnonalphakeyword">)</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    str_items:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"stri"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> $anti:mk_anti n ~c:"str_item" s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"stri"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> st <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> $anti:mk_anti n ~c:"str_item" s$; $st$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> l <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">LIST0</span> <span class="Cnonalphakeyword">[</span> st <span class="Cnonalphakeyword">=</span> str_item<span class="Cnonalphakeyword">;</span> semi <span class="Cnonalphakeyword">-&gt;</span> st <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span>stSem_of_list l
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    top_phrase:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> ph <span class="Cnonalphakeyword">=</span> phrase <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Some</span> ph
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">EOI</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">None</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    use_file:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"#"</span><span class="Cnonalphakeyword">;</span> n <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> dp <span class="Cnonalphakeyword">=</span> opt_expr<span class="Cnonalphakeyword">;</span> semi <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">[</span> <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> # $n$ $dp$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">,</span> stopped_at _loc<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> si <span class="Cnonalphakeyword">=</span> str_item<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> <span class="Cnonalphakeyword">(</span>sil<span class="Cnonalphakeyword">,</span> stopped<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">[</span>si <span class="Cnonalphakeyword">::</span> sil<span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">,</span> stopped<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">EOI</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">[</span><span class="Cnonalphakeyword">]</span><span class="Cnonalphakeyword">,</span> <span class="Cconstructor">None</span><span class="Cnonalphakeyword">)</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    phrase:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"#"</span><span class="Cnonalphakeyword">;</span> n <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> dp <span class="Cnonalphakeyword">=</span> opt_expr<span class="Cnonalphakeyword">;</span> semi <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> # $n$ $dp$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> st <span class="Cnonalphakeyword">=</span> str_item<span class="Cnonalphakeyword">;</span> semi <span class="Cnonalphakeyword">-&gt;</span> st
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_INT:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"int"</span><span class="Cbar">|</span><span class="Cstring">"`int"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">INT</span> <span class="Cnonalphakeyword">_</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_INT32:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"int32"</span><span class="Cbar">|</span><span class="Cstring">"`int32"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">INT32</span> <span class="Cnonalphakeyword">_</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_INT64:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"int64"</span><span class="Cbar">|</span><span class="Cstring">"`int64"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">INT64</span> <span class="Cnonalphakeyword">_</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_NATIVEINT:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"nativeint"</span><span class="Cbar">|</span><span class="Cstring">"`nativeint"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">NATIVEINT</span> <span class="Cnonalphakeyword">_</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_FLOAT:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"flo"</span><span class="Cbar">|</span><span class="Cstring">"`flo"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">FLOAT</span> <span class="Cnonalphakeyword">_</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_CHAR:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"chr"</span><span class="Cbar">|</span><span class="Cstring">"`chr"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">CHAR</span> <span class="Cnonalphakeyword">_</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_UIDENT:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"uid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">UIDENT</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_LIDENT:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"lid"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">LIDENT</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_LABEL:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"~"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span> <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">LABEL</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_OPTLABEL:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"?"</span><span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span> <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">OPTLABEL</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    a_STRING:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"str"</span><span class="Cbar">|</span><span class="Cstring">"`str"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> mk_anti n s
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">STRING</span> <span class="Cnonalphakeyword">_</span> s <span class="Cnonalphakeyword">-&gt;</span> s <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    string_list:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"str_list"</span><span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">LAnt</span> <span class="Cnonalphakeyword">(</span>mk_anti <span class="Cstring">"str_list"</span> s<span class="Cnonalphakeyword">)</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">STRING</span> <span class="Cnonalphakeyword">_</span> x<span class="Cnonalphakeyword">;</span> xs <span class="Cnonalphakeyword">=</span> string_list <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">LCons</span> x xs
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">STRING</span> <span class="Cnonalphakeyword">_</span> x <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">LCons</span> x <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">LNil</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    value_let:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"value"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    value_val:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"value"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    semi:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">";"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    expr_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> e1 <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> comma_expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$, $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e1 <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> e2 <span class="Cnonalphakeyword">=</span> sem_expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"> $e1$; $e2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> e <span class="Cnonalphakeyword">=</span> expr <span class="Cnonalphakeyword">-&gt;</span> e
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:expr&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    patt_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> comma_patt <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $x$, $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> sem_patt <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $x$; $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> patt <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Clet">let</span> i <span class="Cnonalphakeyword">=</span>
              <span class="Cmatch">match</span> x <span class="Cwith">with</span>
              <span class="Cnonalphakeyword">[</span> &lt;:patt@loc<span class="Cnonalphakeyword">&lt;</span> $anti:s$ &gt;&gt; <span class="Cnonalphakeyword">-&gt;</span> &lt;:ident@loc<span class="Cnonalphakeyword">&lt;</span> $anti:s$ &gt;&gt;
              <span class="Cbar">|</span> p <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span>ident_of_patt p <span class="Cnonalphakeyword">]</span>
            <span class="Cin">in</span>
            <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"> $i$ = $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> patt <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:patt&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    ctyp_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">","</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> comma_ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $x$, $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> label_declaration <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $x$; $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"|"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> constructor_declarations <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $x$ | $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"of"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> constructor_arg_list <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $x$ of $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"of"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> constructor_arg_list<span class="Cnonalphakeyword">;</span> <span class="Cstring">"|"</span><span class="Cnonalphakeyword">;</span> z <span class="Cnonalphakeyword">=</span> constructor_declarations <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $ &lt;:ctyp&lt; $x$ of $y$ </span><span class="Cconstructor">&gt;&gt;</span> $ <span class="Cbar">|</span> $z$ &gt;&gt;
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"of"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&amp;"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> amp_ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $x$ of &amp; $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"of"</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"&amp;"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> amp_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"|"</span><span class="Cnonalphakeyword">;</span> z <span class="Cnonalphakeyword">=</span> row_field <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $ &lt;:ctyp&lt; $x$ of &amp; $y$ </span><span class="Cconstructor">&gt;&gt;</span> $ <span class="Cbar">|</span> $z$ &gt;&gt;
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> more_ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $x$ : $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">";"</span><span class="Cnonalphakeyword">;</span> z <span class="Cnonalphakeyword">=</span> label_declaration <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $ &lt;:ctyp&lt; $x$ : $y$ </span><span class="Cconstructor">&gt;&gt;</span> $ <span class="Cnonalphakeyword">;</span> $z$ &gt;&gt;
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"*"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> star_ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $x$ * $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"&amp;"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> amp_ctyp <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $x$ &amp; $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp<span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> y <span class="Cnonalphakeyword">=</span> constructor_arg_list <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> $x$ and $y$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> more_ctyp <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    more_ctyp:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"mutable"</span><span class="Cnonalphakeyword">;</span> x <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> mutable $x$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"`"</span><span class="Cnonalphakeyword">;</span> x <span class="Cnonalphakeyword">=</span> a_ident <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ctyp&lt;</span><span class="Cquotation"> `$x$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> type_kind <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> type_parameter <span class="Cnonalphakeyword">-&gt;</span> x
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    str_item_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"#"</span><span class="Cnonalphakeyword">;</span> n <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> dp <span class="Cnonalphakeyword">=</span> opt_expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> # $n$ $dp$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> st1 <span class="Cnonalphakeyword">=</span> str_item<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> st2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"> $st1$; $st2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> st <span class="Cnonalphakeyword">=</span> str_item <span class="Cnonalphakeyword">-&gt;</span> st
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:str_item&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    sig_item_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> <span class="Cstring">"#"</span><span class="Cnonalphakeyword">;</span> n <span class="Cnonalphakeyword">=</span> a_LIDENT<span class="Cnonalphakeyword">;</span> dp <span class="Cnonalphakeyword">=</span> opt_expr <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> # $n$ $dp$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> sg1 <span class="Cnonalphakeyword">=</span> sig_item<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> sg2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"> $sg1$; $sg2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> sg <span class="Cnonalphakeyword">=</span> sig_item <span class="Cnonalphakeyword">-&gt;</span> sg
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:sig_item&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_type_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> module_type <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_type&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_expr_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> module_expr <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_expr&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    match_case_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">LIST0</span> match_case0 <span class="Cconstructor">SEP</span> <span class="Cstring">"|"</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:match_case&lt;</span><span class="Cquotation"> $list:x$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:match_case&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    binding_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> binding <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:binding&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    rec_binding_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> label_expr <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:rec_binding&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    module_binding_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> b1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> b2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $b1$ and $b2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"module_binding"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"module_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"module_binding" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> m<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $mk_anti n m$ : $mt$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> m<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> me <span class="Cnonalphakeyword">=</span> module_expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $mk_anti n m$ : $mt$ = $me$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $m$ : $mt$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> m <span class="Cnonalphakeyword">=</span> a_UIDENT<span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> mt <span class="Cnonalphakeyword">=</span> module_type<span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> me <span class="Cnonalphakeyword">=</span> module_expr <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"> $m$ : $mt$ = $me$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:module_binding&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    ident_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cstring">"apply"</span>
        <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> j <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $i$ $j$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"."</span>
        <span class="Cnonalphakeyword">[</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> j <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $i$.$j$ </span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span>
      <span class="Cbar">|</span> <span class="Cstring">"simple"</span>
        <span class="Cnonalphakeyword">[</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"id"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ident" n s$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_UIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $uid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> i <span class="Cnonalphakeyword">=</span> a_LIDENT <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $lid:i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">""</span><span class="Cbar">|</span><span class="Cstring">"id"</span><span class="Cbar">|</span><span class="Cstring">"anti"</span><span class="Cbar">|</span><span class="Cstring">"list"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> <span class="Cstring">"."</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:ident&lt;</span><span class="Cquotation"> $anti:mk_anti ~c:"ident" n s$.$i$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"("</span><span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">")"</span> <span class="Cnonalphakeyword">-&gt;</span> i
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_expr_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> ce1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> ce2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $ce1$ and $ce2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> ce1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> ce2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $ce1$ = $ce2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"virtual"</span><span class="Cnonalphakeyword">;</span> <span class="Cnonalphakeyword">(</span>i<span class="Cnonalphakeyword">,</span> ot<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> class_name_and_param <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> virtual $lid:i$ [ $ot$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"virtual"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> ident<span class="Cnonalphakeyword">;</span> ot <span class="Cnonalphakeyword">=</span> opt_comma_ctyp <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Clet">let</span> anti <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BAnt</span> <span class="Cnonalphakeyword">(</span>mk_anti <span class="Cnonalphakeyword">~</span>c:<span class="Cstring">"class_expr"</span> n s<span class="Cnonalphakeyword">)</span> <span class="Cin">in</span>
            <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"> $virtual:anti$ $id:i$ [ $ot$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> class_expr <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_expr&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_type_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> ct1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"and"</span><span class="Cnonalphakeyword">;</span> ct2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $ct1$ and $ct2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> ct1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">"="</span><span class="Cnonalphakeyword">;</span> ct2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $ct1$ = $ct2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> ct1 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span><span class="Cnonalphakeyword">;</span> <span class="Cstring">":"</span><span class="Cnonalphakeyword">;</span> ct2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $ct1$ : $ct2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cstring">"virtual"</span><span class="Cnonalphakeyword">;</span> <span class="Cnonalphakeyword">(</span>i<span class="Cnonalphakeyword">,</span> ot<span class="Cnonalphakeyword">)</span> <span class="Cnonalphakeyword">=</span> class_name_and_param <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> virtual $lid:i$ [ $ot$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> <span class="Cconstructor">`</span><span class="Cconstructor">ANTIQUOT</span> <span class="Cnonalphakeyword">(</span><span class="Cstring">"virtual"</span> <span class="Cas">as</span> n<span class="Cnonalphakeyword">)</span> s<span class="Cnonalphakeyword">;</span> i <span class="Cnonalphakeyword">=</span> ident<span class="Cnonalphakeyword">;</span> ot <span class="Cnonalphakeyword">=</span> opt_comma_ctyp <span class="Cnonalphakeyword">-&gt;</span>
            <span class="Clet">let</span> anti <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">Ast</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">BAnt</span> <span class="Cnonalphakeyword">(</span>mk_anti <span class="Cnonalphakeyword">~</span>c:<span class="Cstring">"class_type"</span> n s<span class="Cnonalphakeyword">)</span> <span class="Cin">in</span>
            <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"> $virtual:anti$ $id:i$ [ $ot$ ] </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> class_type_plus <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_type&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span>
      <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_str_item_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x1 <span class="Cnonalphakeyword">=</span> class_str_item<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> x2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span>
          <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"> $x1$; $x2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> class_str_item <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_str_item&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    class_sig_item_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x1 <span class="Cnonalphakeyword">=</span> class_sig_item<span class="Cnonalphakeyword">;</span> semi<span class="Cnonalphakeyword">;</span> x2 <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">SELF</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"> $x1$; $x2$ </span><span class="Cconstructor">&gt;&gt;</span>
        <span class="Cbar">|</span> x <span class="Cnonalphakeyword">=</span> class_sig_item <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:class_sig_item&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    with_constr_quot:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> with_constr <span class="Cnonalphakeyword">-&gt;</span> x
        <span class="Cbar">|</span> <span class="Cnonalphakeyword">-&gt;</span> <span class="Cconstructor">&lt;:with_constr&lt;</span><span class="Cquotation"></span><span class="Cconstructor">&gt;&gt;</span> <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    patt_eoi:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> patt<span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">EOI</span> <span class="Cnonalphakeyword">-&gt;</span> x <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
    expr_eoi:
      <span class="Cnonalphakeyword">[</span> <span class="Cnonalphakeyword">[</span> x <span class="Cnonalphakeyword">=</span> expr<span class="Cnonalphakeyword">;</span> <span class="Cconstructor">`</span><span class="Cconstructor">EOI</span> <span class="Cnonalphakeyword">-&gt;</span> x <span class="Cnonalphakeyword">]</span> <span class="Cnonalphakeyword">]</span>
    <span class="Cnonalphakeyword">;</span>
  <span class="Cconstructor">END</span><span class="Cnonalphakeyword">;</span>

<span class="Cend">end</span><span class="Cnonalphakeyword">;</span>

<span class="Clet">let</span> <span class="Cmodule">module</span> <span class="Cconstructor">M</span> <span class="Cnonalphakeyword">=</span> <span class="Cconstructor">Register</span><span class="Cnonalphakeyword">.</span><span class="Cconstructor">OCamlSyntaxExtension</span> <span class="Cconstructor">Id</span> <span class="Cconstructor">Make</span> <span class="Cin">in</span> <span class="Cnonalphakeyword">(</span><span class="Cnonalphakeyword">)</span><span class="Cnonalphakeyword">;</span>
</pre>
</body>
</html>
